name: Claude Code Ready

on:
  issues:
    types: [opened, edited]
  issue_comment:
    types: [created, edited]
  pull_request:
    types: [opened, edited, synchronize]
  workflow_dispatch:

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  claude-ready:
    runs-on: ubuntu-latest
    if: |
      (github.event_name == 'issues' && contains(github.event.issue.body || '', '@claude')) ||
      (github.event_name == 'issue_comment' && contains(github.event.comment.body || '', '@claude')) ||
      (github.event_name == 'pull_request' && contains(github.event.pull_request.body || '', '@claude')) ||
      github.event_name == 'workflow_dispatch'
    
    steps:
      - name: Acknowledge Claude Request
        uses: actions/github-script@v7
        with:
          script: |
            
            let issueNumber;
            let commentBody = `🤖 **Claude Code Ready for Theta Clinical Support**
            
            This repository is configured for Claude Code development assistance.
            
            **How to use:**
            1. Use Claude Code CLI directly: \`claude\`
            2. All project context is available in \`CLAUDE.md\`
            3. Configuration is set in \`.claude/config.json\`
            
            **Project Details:**
            - Service: Theta Clinical Support (シータ・クリニカル・サポート)
            - Framework: Astro + React + Tailwind CSS
            - Company: 株式会社シータ・テクノロジーズ
            
            Ready for development! 🚀`;
            
            if (context.eventName === 'issues') {
              issueNumber = context.issue.number;
            } else if (context.eventName === 'issue_comment') {
              issueNumber = context.issue.number;
            }
            
            if (issueNumber) {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issueNumber,
                body: commentBody
              });
            }